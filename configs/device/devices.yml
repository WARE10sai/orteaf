schema_version: "1.0"

devices:
  - id: "cuda_generic"
    display_name: "Generic CUDA Device"
    backend: "cuda"
    architecture: "generic"
    memory:
      max_bytes: 4294967296   # 4 GiB
      shared_bytes: 49152
    supported_dtypes: ["F32", "F16"]
    supported_ops: ["Add", "MatMul", "Relu"]
    capabilities:
      compute_capability: "sm50"
      tensor_cores: "false"
    notes: "フォールバック用のCUDAデバイス定義"

  - id: "cuda_h100_pcie_80gb"
    display_name: "H100 PCIe (80GB)"
    backend: "cuda"
    architecture: "sm90"
    memory:
      max_bytes: 85899345920   # 80 GiB
      shared_bytes: 229376
    supported_dtypes: ["F32", "F16", "F8E4M3", "F8E5M2"]
    supported_ops: ["Add", "MatMul", "Relu", "CustomQuantize"]
    capabilities:
      compute_capability: "sm90"
      tensor_cores: "true"
      pcie_bandwidth_gbps: "128"
    notes: "CUDA 12.2 以上の環境を推奨"

  - id: "cuda_rtx_3070"
    display_name: "GeForce RTX 3070"
    backend: "cuda"
    architecture: "sm86"
    memory:
      max_bytes: 8589934592    # 8 GiB
      shared_bytes: 102400
    supported_dtypes: ["F32", "F16", "F8E4M3", "F8E5M2"]
    supported_ops: ["Add", "MatMul", "Relu", "CustomQuantize"]
    capabilities:
      compute_capability: "sm86"
      tensor_cores: "true"
      memory_type: "GDDR6"
    notes: "Desktop Ampere GPU"

  - id: "mps_generic"
    display_name: "Generic MPS Device"
    backend: "mps"
    architecture: "generic"
    memory:
      max_bytes: 2147483648   # 2 GiB
    supported_dtypes: ["F32"]
    supported_ops: ["Add", "Relu"]
    capabilities:
      metal_version: "3.0"

  - id: "mps_m3_max_40c"
    display_name: "M3 Max (40-core GPU)"
    backend: "mps"
    architecture: "m3"
    memory:
      max_bytes: 34359738368   # 32 GiB
    supported_dtypes: ["F32", "F16"]
    supported_ops: ["Add", "MatMul", "Relu", "CustomQuantize"]
    capabilities:
      metal_version: "3.1"
      supports_attention: "true"

  - id: "mps_m4_pro"
    display_name: "M4 Pro (Integrated GPU)"
    backend: "mps"
    architecture: "m4"
    memory:
      max_bytes: 25769803776   # 24 GiB
    supported_dtypes: ["F32", "F16"]
    supported_ops: ["Add", "MatMul", "Relu", "CustomQuantize"]
    capabilities:
      metal_version: "3.2"
      neural_engine_accel: "true"
    notes: "Apple Silicon M4 Pro unified memory GPU"

  - id: "cpu_generic"
    display_name: "Generic CPU"
    backend: "cpu"
    architecture: "generic"
    memory:
      max_bytes: 17179869184   # 16 GiB
    supported_dtypes: ["F32", "F64", "I32", "I64"]
    supported_ops: ["Add", "MatMul", "Relu", "SpikeThreshold"]
    capabilities:
      isa: "SSE4.2"

  - id: "cpu_zen4"
    display_name: "Zen 4 (AVX-512)"
    backend: "cpu"
    architecture: "zen4"
    memory:
      max_bytes: 34359738368   # 32 GiB
    supported_dtypes: ["F32", "F64", "F16"]
    supported_ops: ["Add", "MatMul", "Relu", "SpikeThreshold", "CustomQuantize"]
    capabilities:
      isa: "AVX-512 + BF16"
